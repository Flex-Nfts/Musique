<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SoundWave ‚Äî Music Player</title>

<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">

<style>
/* ===== STYLE IDENTIQUE (raccourci ici pour lisibilit√©) ===== */
body{margin:0;background:#0d0f14;color:#e8eaf2;font-family:'DM Sans',sans-serif}
.app{display:grid;grid-template-columns:230px 1fr;grid-template-rows:1fr 76px;height:100vh}
.sidebar{background:#13161e;padding:20px}
.main{display:flex;flex-direction:column}
.topbar{display:flex;align-items:center;padding:16px 24px;border-bottom:1px solid #222}
.search-bar{flex:1;margin-left:20px}
.views{flex:1;overflow:auto;padding:24px}
.track-row{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;cursor:pointer}
.track-row:hover{background:#1f2436}
.track-title{flex:1}
.track-actions{display:flex;gap:6px}
.track-delete{background:none;border:none;color:#ff5c5c;cursor:pointer;font-size:14px}
.player-bar{grid-column:2;background:#13161e;display:flex;align-items:center;padding:0 20px}
.toast{position:fixed;bottom:90px;left:50%;transform:translateX(-50%);background:#1a1e2a;padding:10px 18px;border-radius:6px;opacity:0;transition:.3s}
.toast.show{opacity:1}
</style>
</head>
<body>

<div class="app">

<!-- SIDEBAR -->
<aside class="sidebar">
  <div onclick="switchView('explore')">Explore</div>
</aside>

<!-- MAIN -->
<main class="main">

<!-- TOPBAR (LOGIN SUPPRIM√â) -->
<div class="topbar">
  <strong>SoundWave</strong>
  <div class="search-bar">
    <input type="text" placeholder="Search music" oninput="handleSearch(this.value)">
  </div>
</div>

<div class="views">

<div class="view" id="view-explore">
  <h2>Popular</h2>
  <div id="popular-list"></div>
</div>

</div>
</main>

<!-- PLAYER -->
<div class="player-bar">
  <button onclick="prevTrack()">‚èÆ</button>
  <button onclick="togglePlay()">‚ñ∂</button>
  <button onclick="nextTrack()">‚è≠</button>
  <div id="nowPlaying" style="margin-left:20px;">No track</div>
</div>

</div>

<div class="toast" id="toast"></div>
<audio id="audioEl"></audio>

<script>

/* ===== DATA ===== */
let tracks = [
  { id: 1, title: 'Love Song', artist: 'Zak Abel', duration: '3:23' },
  { id: 2, title: 'Kombucha Burps', artist: 'Kendrik Lamar', duration: '5:36' },
  { id: 3, title: 'On The Regular', artist: 'Avicii ft. Derulo', duration: '2:39' },
];

let currentTrackIndex = 0;
let isPlaying = false;
const audio = document.getElementById('audioEl');

/* ===== RENDER ===== */
function renderList(list = tracks) {
  const el = document.getElementById('popular-list');
  el.innerHTML = list.map((t, i) => `
    <div class="track-row" onclick="playTrack(${tracks.indexOf(t)})">
      <div>${i+1}</div>
      <div class="track-title">${t.title} - ${t.artist}</div>
      <div>${t.duration}</div>

      <div class="track-actions" onclick="event.stopPropagation()">
        <button class="track-delete" onclick="deleteTrack(${t.id})">üóë</button>
      </div>
    </div>
  `).join('');
}

/* ===== DELETE TRACK ===== */
function deleteTrack(id) {

  const index = tracks.findIndex(t => t.id === id);
  if (index === -1) return;

  tracks.splice(index, 1);

  // Si on supprime le track en cours
  if (index === currentTrackIndex) {
    isPlaying = false;
    document.getElementById('nowPlaying').textContent = "No track";
  }

  // Ajuste index si besoin
  if (currentTrackIndex >= tracks.length) {
    currentTrackIndex = 0;
  }

  renderList();
  showToast("üóë Track deleted");
}

/* ===== PLAYBACK ===== */
function playTrack(index) {
  if (!tracks.length) return;
  currentTrackIndex = index;
  document.getElementById('nowPlaying').textContent =
    tracks[index].title + " - " + tracks[index].artist;
  isPlaying = true;
}

function togglePlay(){
  isPlaying = !isPlaying;
}

function nextTrack(){
  if(!tracks.length) return;
  currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
  playTrack(currentTrackIndex);
}

function prevTrack(){
  if(!tracks.length) return;
  currentTrackIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;
  playTrack(currentTrackIndex);
}

/* ===== SEARCH ===== */
function handleSearch(q){
  q = q.toLowerCase();
  const filtered = tracks.filter(t =>
    t.title.toLowerCase().includes(q) ||
    t.artist.toLowerCase().includes(q)
  );
  renderList(filtered);
}

/* ===== TOAST ===== */
function showToast(msg){
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),2000);
}

/* ===== INIT ===== */
renderList();

</script>

</body>
</html>
