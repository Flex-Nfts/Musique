<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SoundVault Cloud</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
/* JE GARDE TOUT TON DESIGN EXACT */
:root {
  --bg:         #14141e;
  --bg-card:    #1e1e2e;
  --bg-card-2:  #252535;
  --bg-input:   #1a1a2a;
  --border:     rgba(255,255,255,0.06);
  --border-2:   rgba(255,255,255,0.10);
  --purple:     #7c5cbf;
  --purple-2:   #9b7de8;
  --purple-3:   #b89af0;
  --purple-glow: rgba(124,92,191,0.35);
  --grad:       linear-gradient(135deg, #7c5cbf 0%, #5b8dee 100%);
  --grad-bar:   linear-gradient(90deg, #7c5cbf, #5b8dee);
  --text:       #f0eeff;
  --text-mid:   #6b6b8a;
  --text-dim:   #35354a;
  --blue:       #5b8dee;
  --teal:       #4ecdc4;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;overflow:hidden;font-family:'Nunito',sans-serif;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}

/* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
.shell{display:grid;grid-template-columns:400px 1fr;height:100vh;position:relative;z-index:1}

/* ‚îÄ‚îÄ LEFT PANEL ‚îÄ‚îÄ */
.left{ background:var(--bg-card); display:flex;flex-direction:column; border-right:1px solid var(--border); position:relative;overflow:hidden;}
.left-glow{ position:absolute;top:0;left:0;right:0;bottom:0; pointer-events:none;z-index:0; opacity:0.18; transition:background 0.8s ease;}
.left-top{ display:flex;align-items:center;justify-content:space-between; padding:22px 24px 0;position:relative;z-index:2;}
.chevron-btn,.heart-btn{ width:36px;height:36px; background:rgba(255,255,255,0.07); border:1px solid var(--border-2); border-radius:50%;display:flex;align-items:center;justify-content:center; cursor:pointer;font-size:14px;color:rgba(255,255,255,0.6); transition:0.2s;}
.heart-btn.liked{color:#ff6b8a;border-color:rgba(255,107,138,0.3);background:rgba(255,107,138,0.1)}
.now-playing-label{font-size:12px;font-weight:700;letter-spacing:0.12em;text-transform:uppercase;color:var(--text-mid)}

.cover-area{ flex:1;display:flex;align-items:center;justify-content:center; position:relative;z-index:2;padding:10px 0 0;}
.cover-ring-outer{ width:230px;height:230px;border-radius:50%; background:var(--bg-card-2); box-shadow:0 0 60px rgba(124,92,191,0.25), 0 0 0 1px rgba(255,255,255,0.07); display:flex;align-items:center;justify-content:center; position:relative;overflow:hidden; transition:box-shadow 0.5s;}
.cover-ring-outer.playing{ box-shadow:0 0 80px rgba(124,92,191,0.5), 0 0 0 1px rgba(155,125,232,0.3); animation:cover-pulse 3s ease-in-out infinite;}
@keyframes cover-pulse{0%,100%{box-shadow:0 0 60px rgba(124,92,191,0.4),0 0 0 1px rgba(155,125,232,0.3)}50%{box-shadow:0 0 100px rgba(124,92,191,0.7),0 0 0 1px rgba(155,125,232,0.5)}}
.cover-img{ width:100%;height:100%;object-fit:cover;border-radius:50%; transition:transform 0.3s;}
.cover-ring-outer.playing .cover-img{animation:spin-slow 20s linear infinite}
@keyframes spin-slow{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
.cover-placeholder{ width:100%;height:100%;display:flex;align-items:center;justify-content:center; font-size:64px;opacity:0.15;}

.track-meta{ padding:16px 28px 8px;text-align:center;position:relative;z-index:2;}
.track-title{font-size:22px;font-weight:800;letter-spacing:-0.02em;color:var(--text)}
.track-artist{font-size:13px;color:var(--text-mid);margin-top:4px;font-weight:400}

.progress-area{ padding:0 28px;position:relative;z-index:2;}
.progress-times{display:flex;justify-content:space-between;margin-bottom:6px}
.prog-time{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--text-mid)}
.prog-bar{ width:100%;height:4px;background:rgba(255,255,255,0.08); border-radius:4px;cursor:pointer;position:relative;transition:height 0.15s;}
.prog-fill{ height:100%;background:var(--grad-bar);border-radius:4px; transition:width 0.1s linear;pointer-events:none;position:relative;}

.controls-row{ display:flex;align-items:center;justify-content:center; gap:8px;padding:14px 28px 10px;position:relative;z-index:2;}
.ctrl-btn{ width:38px;height:38px;background:transparent;border:none; color:rgba(255,255,255,0.35);font-size:15px;cursor:pointer; display:flex;align-items:center;justify-content:center; border-radius:50%;transition:all 0.2s;}
.ctrl-btn:hover{color:var(--text);background:rgba(255,255,255,0.07)}
.ctrl-play{ width:56px;height:56px; background:var(--grad); color:#fff;font-size:20px; box-shadow:0 6px 24px var(--purple-glow); border-radius:50%;}

.vol-row{ display:flex;align-items:center;gap:10px; padding:0 28px 10px;position:relative;z-index:2;}
.vol-track{flex:1;height:3px;background:rgba(255,255,255,0.08);border-radius:3px;cursor:pointer;position:relative}
.vol-fill{height:100%;background:rgba(255,255,255,0.35);border-radius:3px;pointer-events:none}
input[type=range].vol-input{ position:absolute;inset:-10px 0;width:100%; opacity:0;cursor:pointer;-webkit-appearance:none;}

/* ‚îÄ‚îÄ RIGHT PANEL ‚îÄ‚îÄ */
.right{ display:flex;flex-direction:column;overflow:hidden; background:var(--bg);position:relative;}
.hero-banner{ position:relative;height:180px;overflow:hidden;flex-shrink:0;}
.hero-bg-placeholder{ width:100%;height:100%; background:linear-gradient(135deg,#1e1e3a 0%,#2d1b4e 100%);}
.hero-content{ position:absolute;bottom:18px;left:24px;right:60px;}
.hero-playlist-name{font-size:22px;font-weight:800;letter-spacing:-0.02em}

/* IMPORT ZONE ADDED */
.bulk-import-area { padding: 20px; background: var(--bg-card); margin: 15px; border-radius: 15px; border: 1px solid var(--border); }
.bulk-textarea { width: 100%; height: 80px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 10px; color: white; padding: 10px; font-family: 'Nunito'; margin-bottom: 10px; }
.btn-import-bulk { background: var(--grad); border: none; color: white; padding: 10px 20px; border-radius: 10px; font-weight: 800; cursor: pointer; box-shadow: 0 4px 14px var(--purple-glow); }

.track-list-scroll{ flex:1;overflow-y:auto;padding:0 12px 130px; }
.t-row{ display:flex;align-items:center;gap:12px; padding:10px 12px;border-radius:14px;cursor:pointer; border:1px solid transparent;margin-bottom:2px; transition:all 0.2s;}
.t-row:hover{background:var(--bg-card);border-color:var(--border)}
.t-row.playing{background:var(--bg-card-2);border-color:rgba(124,92,191,0.25)}
.t-thumb-empty{ width:48px;height:48px;background:var(--bg-card-2); border:1px solid var(--border);border-radius:12px; display:flex;align-items:center;justify-content:center; font-size:18px;flex-shrink:0;}
.t-info{flex:1;min-width:0}
.t-title{font-size:13px;font-weight:700;color:var(--text);}
.t-artist{font-size:11px;color:var(--text-mid);}
.t-del-btn { color: #ff5555; font-size: 18px; cursor: pointer; padding: 5px; }

/* MINI PLAYER */
.mini-player{ position:absolute;bottom:14px;left:16px;right:16px; background:rgba(30,28,48,0.96); backdrop-filter:blur(40px); border:1px solid rgba(124,92,191,0.2); border-radius:18px; padding:12px 16px; display:flex;align-items:center;gap:12px; z-index:20; box-shadow:0 8px 40px rgba(0,0,0,0.6);}
.mini-btn-play{background:var(--grad); width:35px; height:35px; border-radius:50%; border:none; color:white; cursor:pointer;}
</style>
</head>
<body>

<div class="shell">

  <div class="left">
    <div class="left-glow" id="leftGlow"></div>
    <div class="left-top">
      <div class="chevron-btn">‚åÑ</div>
      <span class="now-playing-label">Lecteur Cloud</span>
      <div class="heart-btn" id="heartBtn" onclick="toggleLike()">‚ô°</div>
    </div>

    <div class="cover-area">
      <div class="cover-ring-outer" id="coverRing">
        <div class="cover-placeholder">‚ô´</div>
        <img id="coverImg" class="cover-img" src="" style="display:none;position:absolute;inset:0;border-radius:50%">
      </div>
    </div>

    <div class="track-meta">
      <div class="track-title" id="trackTitle">‚Äî</div>
      <div class="track-artist" id="trackArtist">Pr√™t pour l'√©coute</div>
    </div>

    <div class="progress-area">
      <div class="progress-times">
        <span class="prog-time" id="progElapsed">0:00</span>
        <span class="prog-time" id="progDuration">0:00</span>
      </div>
      <div class="prog-bar" onclick="seek(event)">
        <div class="prog-fill" id="progFill" style="width:0%"></div>
      </div>
    </div>

    <div class="controls-row">
      <button class="ctrl-btn" onclick="prevTrack()">‚èÆ</button>
      <button class="ctrl-btn ctrl-play" id="playBtn" onclick="togglePlay()">‚ñ∂</button>
      <button class="ctrl-btn" onclick="nextTrack()">‚è≠</button>
    </div>

    <div class="vol-row">
      <span class="vol-icon">üîà</span>
      <div class="vol-track">
        <div class="vol-fill" id="volFill" style="width:80%"></div>
        <input type="range" class="vol-input" min="0" max="100" value="80" oninput="setVolume(this.value)">
      </div>
      <span class="vol-icon">üîä</span>
    </div>
  </div>

  <div class="right">
    <div class="hero-banner">
      <div class="hero-bg-placeholder"></div>
      <div class="hero-content">
        <div class="hero-playlist-name">Ma Musique Dropbox</div>
        <div class="hero-genre" id="trackCount">0 titres import√©s</div>
      </div>
    </div>

    <div class="bulk-import-area">
      <h3 style="font-size:14px; margin-bottom:10px;">üöÄ Importation Rapide (Nom | Artiste | Lien)</h3>
      <textarea id="bulkInput" class="bulk-textarea" placeholder="Rai 01 | Suno | https://www.dropbox.com/s/.../son.mp3?dl=0"></textarea>
      <button class="btn-import-bulk" onclick="importBulk()">Importer la liste</button>
    </div>

    <div class="track-list-scroll" id="trackList">
      </div>

    <div class="mini-player">
      <div style="flex:1">
        <div id="miniTitle" style="font-weight:bold; font-size:13px;">‚Äî</div>
        <div id="miniArtist" style="font-size:10px; color:var(--text-mid)">S√©lectionnez une musique</div>
      </div>
      <button class="mini-btn-play" onclick="togglePlay()" id="miniPlayBtn">‚ñ∂</button>
    </div>
  </div>
</div>

<script>
let vault = JSON.parse(localStorage.getItem('SoundVault_Cloud')) || [];
let currentIdx = -1;
let audio = new Audio();
let isLiked = false;

// SAUVEGARDE
function save() { 
    localStorage.setItem('SoundVault_Cloud', JSON.stringify(vault)); 
    render(); 
}

// IMPORTATION GROUP√âE (La fonction que tu voulais)
function importBulk() {
    const input = document.getElementById('bulkInput').value;
    const lines = input.split('\n');
    let added = 0;

    lines.forEach(line => {
        if(line.includes('|')) {
            let [titre, artiste, url] = line.split('|').map(s => s.trim());
            if(url && url.includes('http')) {
                // Conversion Dropbox automatique
                url = url.replace('dl=0', 'raw=1');
                vault.push({ titre, artiste, url, fav: false });
                added++;
            }
        }
    });

    if(added > 0) {
        document.getElementById('bulkInput').value = "";
        alert(added + " musiques ajout√©es avec succ√®s !");
        save();
    } else {
        alert("Format incorrect. Utilise : Titre | Artiste | Lien");
    }
}

// AFFICHAGE DE LA LISTE
function render() {
    const list = document.getElementById('trackList');
    document.getElementById('trackCount').innerText = vault.length + " titres import√©s";
    
    list.innerHTML = vault.map((t, i) => `
        <div class="t-row ${currentIdx === i ? 'playing' : ''}" onclick="playTrack(${i})">
            <div class="t-thumb-empty">‚ô´</div>
            <div class="t-info">
                <div class="t-title">${t.titre}</div>
                <div class="t-artist">${t.artiste}</div>
            </div>
            <div class="t-del-btn" onclick="event.stopPropagation(); deleteTrack(${i})">‚úï</div>
        </div>
    `).join('');
}

// LECTURE
function playTrack(i) {
    currentIdx = i;
    const t = vault[i];
    
    document.getElementById('trackTitle').innerText = t.titre;
    document.getElementById('trackArtist').innerText = t.artiste;
    document.getElementById('miniTitle').innerText = t.titre;
    document.getElementById('miniArtist').innerText = t.artiste;
    
    audio.src = t.url;
    audio.play();
    
    document.getElementById('playBtn').innerText = "‚è∏";
    document.getElementById('miniPlayBtn').innerText = "‚è∏";
    document.getElementById('coverRing').classList.add('playing');
    render();
}

function togglePlay() {
    if(!audio.src && vault.length > 0) return playTrack(0);
    if(audio.paused) {
        audio.play();
        document.getElementById('playBtn').innerText = "‚è∏";
        document.getElementById('miniPlayBtn').innerText = "‚è∏";
        document.getElementById('coverRing').classList.add('playing');
    } else {
        audio.pause();
        document.getElementById('playBtn').innerText = "‚ñ∂";
        document.getElementById('miniPlayBtn').innerText = "‚ñ∂";
        document.getElementById('coverRing').classList.remove('playing');
    }
}

function nextTrack() {
    if(currentIdx < vault.length - 1) playTrack(currentIdx + 1);
    else playTrack(0);
}

function prevTrack() {
    if(currentIdx > 0) playTrack(currentIdx - 1);
}

function deleteTrack(i) {
    vault.splice(i, 1);
    save();
}

function setVolume(v) {
    audio.volume = v / 100;
    document.getElementById('volFill').style.width = v + "%";
}

function toggleLike() {
    isLiked = !isLiked;
    const btn = document.getElementById('heartBtn');
    btn.innerText = isLiked ? "‚ù§Ô∏è" : "‚ô°";
    btn.classList.toggle('liked', isLiked);
}

// BARRE DE PROGRESSION
audio.ontimeupdate = () => {
    if(audio.duration) {
        const pct = (audio.currentTime / audio.duration) * 100;
        document.getElementById('progFill').style.width = pct + "%";
        document.getElementById('progElapsed').innerText = formatTime(audio.currentTime);
        document.getElementById('progDuration').innerText = formatTime(audio.duration);
    }
};

function formatTime(s) {
    let min = Math.floor(s / 60);
    let sec = Math.floor(s % 60);
    return min + ":" + (sec < 10 ? "0" + sec : sec);
}

function seek(e) {
    const bar = e.currentTarget;
    const pct = e.offsetX / bar.offsetWidth;
    audio.currentTime = pct * audio.duration;
}

// Lancer au d√©marrage
render();
</script>

</body>
</html>
